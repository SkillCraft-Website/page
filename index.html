<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillCraft - Tasks & Trajectories</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        /* ===== Navigation Bar ===== */
        .nav-bar {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 0 20px;
            display: flex;
            align-items: center;
            flex-shrink: 0;
            height: 52px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }
        
        .nav-brand {
            font-size: 18px;
            font-weight: 700;
            color: #fff;
            margin-right: 40px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .nav-tabs {
            display: flex;
            gap: 4px;
        }
        
        .nav-tab {
            padding: 14px 24px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-tab:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .nav-tab.active {
            color: #fff;
            border-bottom-color: #667eea;
            background: rgba(255, 255, 255, 0.08);
        }
        
        /* ===== Page Containers ===== */
        .page-container {
            flex: 1;
            display: none;
            flex-direction: column;
            overflow: hidden;
        }
        
        .page-container.active {
            display: flex;
        }
        
        /* ===== Shared Styles ===== */
        .top-bar {
            background: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .brand {
            font-size: 18px;
            font-weight: 600;
            color: #007AFF;
            margin-right: 16px;
        }
        
        select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            font-size: 14px;
            min-width: 180px;
            outline: none;
            transition: border-color 0.2s;
        }
        
        select:focus {
            border-color: #007AFF;
        }
        
        .model-select, .task-select {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-weight: 500;
            min-width: 200px;
        }
        
        .model-select option, .model-select optgroup,
        .task-select option, .task-select optgroup {
            background: white;
            color: #333;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .panel-header {
            padding: 14px 16px;
            font-weight: 600;
            font-size: 14px;
            border-bottom: 1px solid #e0e0e0;
            background: #fafafa;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }
        
        .empty-state {
            text-align: center;
            color: #999;
            padding: 40px 20px;
        }
        
        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 8px;
            color: #666;
        }
        
        /* ===== Trajectory Page Styles ===== */
        .stats-panel {
            width: 320px;
            min-width: 280px;
            background: white;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .stats-container {
            font-size: 13px;
        }
        
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 16px;
        }
        
        .stats-table th, .stats-table td {
            padding: 8px 10px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .stats-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
            font-size: 11px;
            text-transform: uppercase;
        }
        
        .stats-table tr.result-row td {
            padding-top: 12px;
            border-top: 2px solid #e0e0e0;
        }
        
        .pass-badge {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .fail-badge {
            background: #ffebee;
            color: #c62828;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .pattern-summary {
            background: #f0f7ff;
            border: 1px solid #b3d4fc;
            border-radius: 8px;
            padding: 12px;
            margin-top: 8px;
        }
        
        .pattern-summary h4 {
            font-size: 13px;
            color: #1565c0;
            margin-bottom: 10px;
        }
        
        .pattern-stats {
            display: flex;
            gap: 16px;
            margin-bottom: 12px;
        }
        
        .pattern-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .pattern-stat .stat-value {
            font-size: 20px;
            font-weight: 600;
            color: #1976d2;
        }
        
        .pattern-stat .stat-label {
            font-size: 11px;
            color: #666;
        }
        
        .pattern-list {
            border-top: 1px solid #b3d4fc;
            padding-top: 10px;
        }
        
        .pattern-item {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 6px 10px;
            margin-bottom: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .pattern-item:hover {
            background: #e3f2fd;
            border-color: #90caf9;
        }
        
        .pattern-name {
            font-weight: 600;
            font-size: 12px;
            color: #1565c0;
            display: block;
        }
        
        .pattern-desc {
            font-size: 11px;
            color: #666;
        }
        
        .pattern-more {
            font-size: 11px;
            color: #666;
            font-style: italic;
            margin-top: 4px;
        }
        
        /* Global Tooltip */
        #globalTooltip {
            position: fixed;
            background: white;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 12px;
            font-size: 12px;
            font-family: 'Consolas', 'Monaco', monospace;
            white-space: pre-wrap;
            max-width: 500px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 999999;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            display: none;
            color: #333;
            line-height: 1.4;
        }
        
        #globalTooltip .tooltip-title {
            font-weight: 600;
            color: #1565c0;
            margin-bottom: 8px;
            font-size: 13px;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 6px;
        }
        
        #globalTooltip .tooltip-code {
            background: #f5f5f5;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 8px;
            font-size: 11px;
            color: #444;
        }
        
        /* Trajectory Panels */
        .traj-panels {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .traj-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #e0e0e0;
            overflow: hidden;
        }
        
        .traj-panel:last-child {
            border-right: none;
        }
        
        .traj-panel .panel-header.normal {
            background: linear-gradient(135deg, #e3f2fd, #f5f5f5);
            color: #1565c0;
        }
        
        .traj-panel .panel-header.reuse {
            background: linear-gradient(135deg, #e8f5e9, #f5f5f5);
            color: #2e7d32;
        }
        
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
            background: #f8f9fa;
        }
        
        /* Messages */
        .message {
            margin-bottom: 12px;
            border-radius: 8px;
            overflow: hidden;
            background: white;
            border: 1px solid #e0e0e0;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: border-color 0.2s, box-shadow 0.2s;
            cursor: default;
        }
        
        .message.has-raw-tooltip:hover {
            border-color: #90caf9;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .message-header {
            padding: 8px 12px;
            font-weight: 600;
            font-size: 13px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .message-content {
            padding: 10px 12px;
        }
        
        .message-content pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Consolas', 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            line-height: 1.5;
            max-height: 300px;
            overflow-y: auto;
            margin: 0;
            background: transparent;
        }

        /* User message markdown-like styling */
        .user-message .user-markdown {
            font-size: 13px;
            line-height: 1.65;
            color: #1f2a37;
            max-height: 300px;
            overflow-y: auto;
        }

        .user-message .user-markdown .md-line,
        .user-message .user-markdown .md-h1,
        .user-message .user-markdown .md-h2,
        .user-message .user-markdown .md-h3 {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .user-message .user-markdown .md-h1 {
            font-size: 15px;
            font-weight: 700;
            color: #0d47a1;
            margin: 6px 0 8px;
        }

        .user-message .user-markdown .md-h2 {
            font-size: 14px;
            font-weight: 600;
            color: #1565c0;
            margin: 10px 0 6px;
            padding-bottom: 2px;
            border-bottom: 1px solid #dbe7f3;
        }

        .user-message .user-markdown .md-h3 {
            font-size: 13px;
            font-weight: 600;
            color: #1e88e5;
            margin: 8px 0 4px;
        }

        .user-message .user-markdown .md-bold {
            font-weight: 600;
            color: #0d47a1;
            background: #e3f2fd;
            padding: 0 3px;
            border-radius: 3px;
        }

        .user-message .user-markdown .md-spacer {
            height: 8px;
        }
        
        .user-message .message-header {
            background: #e3f2fd;
            color: #1565c0;
        }
        
        .assistant-message .message-header {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        .tool-call .message-header {
            background: #fff3e0;
            color: #e65100;
        }
        
        .tool-output .message-header {
            background: #f3e5f5;
            color: #7b1fa2;
        }
        
        .tool-output .message-content {
            background: #fafafa;
        }
        
        /* Task Info Section */
        .task-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
        }
        
        .task-info h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .task-info .task-desc {
            font-size: 14px;
            line-height: 1.5;
            opacity: 0.95;
            margin-bottom: 8px;
        }
        
        .task-info .view-details-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.2s;
            margin-top: 10px;
            border: 1px solid rgba(255,255,255,0.3);
            cursor: pointer;
        }
        
        .task-info .view-details-btn:hover {
            background: rgba(255,255,255,0.35);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-1px);
        }
        
        .progress-text {
            font-size: 12px;
            color: #666;
            min-width: 60px;
            font-family: monospace;
        }
        
        /* ===== Task Showcase Page Styles ===== */
        .sidebar {
            width: 320px;
            min-width: 280px;
            background: white;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .task-list {
            list-style: none;
        }
        
        .task-item {
            padding: 12px 14px;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #eee;
        }
        
        .task-item:hover {
            background: #f0f7ff;
            border-color: #007AFF;
        }
        
        .task-item.active {
            background: #e8f4ff;
            border-color: #007AFF;
        }
        
        .task-item-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .task-item-meta {
            font-size: 12px;
            color: #666;
            display: flex;
            gap: 8px;
        }
        
        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .badge-easy { background: #d4edda; color: #155724; }
        .badge-medium { background: #fff3cd; color: #856404; }
        .badge-hard { background: #f8d7da; color: #721c24; }
        .badge-api { background: #e7f3ff; color: #004085; }
        .badge-local { background: #f0e6ff; color: #5a2d82; }
        
        .content-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .content-header {
            padding: 16px 20px;
            background: white;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .content-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .content-meta {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            color: #666;
        }
        
        .meta-value {
            font-weight: 600;
            color: #333;
        }
        
        .tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid #e0e0e0;
            padding: 0 20px;
        }
        
        .tab {
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            color: #666;
            transition: all 0.2s;
        }
        
        .tab:hover {
            color: #007AFF;
        }
        
        .tab.active {
            color: #007AFF;
            border-bottom-color: #007AFF;
        }
        
        .tab-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #fafafa;
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
        }
        
        .markdown-content {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            max-width: none;
            width: 100%;
        }
        
        .markdown-content h1 {
            font-size: 24px;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid #eee;
        }
        
        .markdown-content h2 {
            font-size: 20px;
            margin-top: 24px;
            margin-bottom: 12px;
            color: #333;
        }
        
        .markdown-content h3 {
            font-size: 16px;
            margin-top: 20px;
            margin-bottom: 10px;
            color: #444;
        }
        
        .markdown-content h4 {
            font-size: 14px;
            margin-top: 16px;
            margin-bottom: 8px;
            color: #555;
        }
        
        .markdown-content p {
            margin-bottom: 12px;
            line-height: 1.6;
        }
        
        .markdown-content ul, .markdown-content ol {
            margin-bottom: 12px;
            padding-left: 24px;
        }
        
        .markdown-content li {
            margin-bottom: 6px;
            line-height: 1.5;
        }
        
        .markdown-content .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            border-radius: 6px;
            padding: 16px;
            overflow-x: auto;
            margin: 12px 0;
            font-family: 'SF Mono', Monaco, 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
        }
        
        .markdown-content .inline-code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'SF Mono', Monaco, 'Courier New', monospace;
            font-size: 0.9em;
            color: #c7254e;
        }
        
        .config-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .config-section h3 {
            font-size: 16px;
            margin-bottom: 12px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
        }
        
        .config-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
        }
        
        .config-label {
            font-size: 11px;
            text-transform: uppercase;
            color: #666;
            margin-bottom: 4px;
        }
        
        .config-value {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }
        
        .tool-list {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        
        .tool-tag {
            background: #e7f3ff;
            color: #004085;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .tool-tag.mcp {
            background: #fff3cd;
            color: #856404;
        }
        
        .showcase-pattern-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 16px;
        }
        
        .showcase-pattern-info h3 {
            color: white;
            margin-bottom: 12px;
        }
        
        .showcase-pattern-stats {
            display: flex;
            gap: 24px;
        }
        
        .showcase-pattern-stat {
            text-align: center;
        }
        
        .showcase-pattern-stat-value {
            font-size: 28px;
            font-weight: 700;
        }
        
        .showcase-pattern-stat-label {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .raw-json {
            background: #1e1e1e;
            color: #d4d4d4;
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            font-family: 'SF Mono', Monaco, 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            white-space: pre-wrap;
        }
        
        .search-box {
            padding: 10px 14px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            width: 100%;
            margin-bottom: 16px;
        }
        
        .search-box:focus {
            outline: none;
            border-color: #007AFF;
        }
        
        .stats-summary {
            display: flex;
            align-items: center;
            gap: 20px;
            font-size: 13px;
            color: #666;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .stat-value {
            font-weight: 600;
            color: #333;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .stats-panel, .sidebar {
                width: 260px;
                min-width: 240px;
            }
        }

        @media (max-width: 900px) {
            .main-content {
                flex-direction: column;
            }

            .stats-panel, .sidebar {
                width: 100%;
                max-height: 200px;
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
            }

            .traj-panels {
                flex-direction: column;
            }

            .traj-panel {
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
            }
        }

        /* ===== Homepage Styles ===== */
        #homePage {
            overflow-y: auto;
            background: #fff;
        }

        .home-section {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 32px;
            width: 100%;
        }

        /* Hero */
        .home-hero {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #1a1a2e 100%);
            color: #fff;
            text-align: center;
            padding: 64px 32px 56px;
            position: relative;
            overflow: hidden;
        }

        .home-hero::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(ellipse at 30% 50%, rgba(102,126,234,0.15) 0%, transparent 70%),
                        radial-gradient(ellipse at 70% 50%, rgba(118,75,162,0.12) 0%, transparent 70%);
            pointer-events: none;
        }

        .home-hero-inner {
            position: relative;
            z-index: 1;
            max-width: 900px;
            margin: 0 auto;
        }

        .home-hero h1 {
            font-size: 48px;
            font-weight: 800;
            letter-spacing: -1px;
            margin-bottom: 12px;
            background: linear-gradient(135deg, #fff 0%, #c8d6f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .home-hero .subtitle {
            font-size: 22px;
            font-weight: 400;
            color: rgba(255,255,255,0.85);
            margin-bottom: 24px;
            line-height: 1.5;
        }

        .home-hero .tagline {
            font-size: 15px;
            color: rgba(255,255,255,0.6);
            margin-bottom: 32px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .home-hero-btns {
            display: flex;
            justify-content: center;
            gap: 14px;
            flex-wrap: wrap;
        }

        .home-hero-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 22px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.25s;
            border: 1.5px solid rgba(255,255,255,0.25);
            color: #fff;
            background: rgba(255,255,255,0.08);
        }

        .home-hero-btn:hover {
            background: rgba(255,255,255,0.18);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .home-hero-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: transparent;
        }

        .home-hero-btn.primary:hover {
            box-shadow: 0 4px 20px rgba(102,126,234,0.4);
        }

        /* Authors */
        .home-authors {
            text-align: center;
            padding: 36px 32px 20px;
            background: #fafbfe;
            border-bottom: 1px solid #eef0f5;
        }

        .home-authors-list {
            max-width: 860px;
            margin: 0 auto 12px;
            font-size: 15px;
            line-height: 2;
            color: #444;
        }

        .home-authors-list a {
            color: #4a6fa5;
            text-decoration: none;
        }

        .home-authors-list a:hover {
            text-decoration: underline;
        }

        .home-authors-list sup {
            font-size: 10px;
            color: #888;
            margin-left: 1px;
        }

        .home-affiliations {
            max-width: 860px;
            margin: 0 auto;
            font-size: 12.5px;
            color: #888;
            line-height: 1.8;
        }

        .home-affiliations sup {
            font-size: 9px;
            margin-right: 2px;
        }

        .home-equal {
            font-size: 12px;
            color: #999;
            margin-top: 6px;
        }

        /* Explore Cards */
        .home-explore {
            padding: 40px 32px;
            background: #f8f9fb;
        }

        .home-explore-inner {
            max-width: 800px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .home-explore-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            padding: 28px 24px;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: flex;
            flex-direction: column;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(102,126,234,0.25);
            position: relative;
            overflow: hidden;
        }

        .home-explore-card::after {
            content: '\2192';
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 28px;
            opacity: 0.5;
            transition: all 0.3s;
        }

        .home-explore-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(102,126,234,0.4);
        }

        .home-explore-card:hover::after {
            opacity: 1;
            right: 16px;
        }

        .home-explore-card:nth-child(2) {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            box-shadow: 0 4px 15px rgba(67,233,123,0.25);
        }

        .home-explore-card:nth-child(2):hover {
            box-shadow: 0 8px 30px rgba(67,233,123,0.4);
        }

        .home-explore-card .card-icon {
            font-size: 32px;
        }

        .home-explore-card .card-title {
            font-size: 20px;
            font-weight: 700;
        }

        .home-explore-card .card-desc {
            font-size: 14px;
            opacity: 0.9;
            line-height: 1.5;
            padding-right: 32px;
        }

        /* Section Headings */
        .home-section-title {
            font-size: 28px;
            font-weight: 700;
            color: #1a1a2e;
            margin-bottom: 8px;
            text-align: center;
        }

        .home-section-sub {
            font-size: 15px;
            color: #777;
            text-align: center;
            margin-bottom: 32px;
            line-height: 1.5;
        }

        /* Abstract */
        .home-abstract-section {
            padding: 48px 32px 40px;
        }

        .home-abstract {
            max-width: 860px;
            margin: 0 auto;
            font-size: 15.5px;
            line-height: 1.8;
            color: #444;
            text-align: justify;
        }

        .home-abstract p {
            margin-bottom: 14px;
        }

        .home-abstract strong {
            color: #1a1a2e;
        }

        /* Figures */
        .home-figure-section {
            padding: 0 32px 48px;
        }

        .home-figure {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }

        .home-figure img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.08);
            border: 1px solid #eee;
        }

        .home-figure-caption {
            margin-top: 14px;
            font-size: 13.5px;
            color: #777;
            line-height: 1.6;
            max-width: 760px;
            margin-left: auto;
            margin-right: auto;
        }

        .home-figure-caption strong {
            color: #444;
        }

        /* Stats Strip */
        .home-stats-section {
            padding: 0 32px 48px;
        }

        .home-stats-strip {
            max-width: 900px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 16px;
        }

        .home-stat-card {
            background: #f8f9fb;
            border: 1px solid #eef0f5;
            border-radius: 12px;
            padding: 20px 12px;
            text-align: center;
            transition: all 0.2s;
        }

        .home-stat-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102,126,234,0.1);
        }

        .home-stat-number {
            font-size: 36px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }

        .home-stat-label {
            font-size: 12.5px;
            color: #888;
            margin-top: 6px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Results Table */
        .home-results-section {
            padding: 48px 32px;
            background: #f8f9fb;
        }

        .home-results-table-wrap {
            max-width: 1060px;
            margin: 0 auto;
            overflow-x: auto;
            border-radius: 12px;
            box-shadow: 0 2px 16px rgba(0,0,0,0.06);
        }

        .home-results-table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            font-size: 14px;
        }

        .home-results-table thead th {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            padding: 12px 14px;
            font-weight: 600;
            font-size: 12.5px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            white-space: nowrap;
            text-align: center;
            border-bottom: none;
        }

        .home-results-table thead th:first-child {
            text-align: left;
            border-radius: 12px 0 0 0;
        }

        .home-results-table thead th:last-child {
            border-radius: 0 12px 0 0;
        }

        .home-results-table tbody td {
            padding: 11px 14px;
            border-bottom: 1px solid #f0f0f0;
            text-align: center;
            white-space: nowrap;
        }

        .home-results-table tbody td:first-child {
            text-align: left;
            font-weight: 600;
            color: #333;
        }

        .home-results-table tbody tr:hover {
            background: #f5f8ff;
        }

        .home-results-table tbody tr:last-child td {
            border-bottom: none;
        }

        .home-results-table tbody tr:last-child td:first-child {
            border-radius: 0 0 0 12px;
        }

        .home-results-table tbody tr:last-child td:last-child {
            border-radius: 0 0 12px 0;
        }

        .home-results-table .model-type-row td {
            background: #f0f2f8;
            font-weight: 700;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #667eea;
            padding: 8px 14px;
            text-align: left;
        }

        .delta-positive {
            color: #2e7d32;
            font-weight: 600;
        }

        .delta-negative {
            color: #c62828;
            font-weight: 600;
        }

        .delta-neutral {
            color: #888;
            font-weight: 500;
        }

        .home-results-table .success-base {
            color: #666;
        }

        .home-results-table .success-skill {
            color: #2e7d32;
            font-weight: 600;
        }

        .token-reduction {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 13px;
        }

        .token-reduction.high {
            background: #e8f5e9;
            color: #1b5e20;
        }

        .token-reduction.medium {
            background: #f1f8e9;
            color: #33691e;
        }

        .token-reduction.low {
            background: #fff8e1;
            color: #f57f17;
        }

        .home-table-note {
            max-width: 1060px;
            margin: 12px auto 0;
            font-size: 12.5px;
            color: #999;
            text-align: center;
        }

        /* Key Findings */
        .home-findings-section {
            padding: 48px 32px;
        }

        .home-findings-grid {
            max-width: 1060px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .home-finding-card {
            background: #fff;
            border: 1px solid #eef0f5;
            border-radius: 14px;
            padding: 28px 24px;
            transition: all 0.25s;
            position: relative;
        }

        .home-finding-card:hover {
            box-shadow: 0 6px 24px rgba(0,0,0,0.08);
            transform: translateY(-3px);
        }

        .home-finding-card .finding-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            font-weight: 700;
            font-size: 16px;
            margin-bottom: 14px;
        }

        .home-finding-card h3 {
            font-size: 17px;
            font-weight: 700;
            color: #1a1a2e;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .home-finding-card p {
            font-size: 14px;
            color: #666;
            line-height: 1.65;
        }

        .home-finding-card .finding-metric {
            display: inline-block;
            margin-top: 14px;
            padding: 6px 14px;
            border-radius: 8px;
            background: #f0f4ff;
            color: #4a5db5;
            font-weight: 700;
            font-size: 14px;
        }

        /* Citation */
        .home-citation-section {
            padding: 48px 32px;
            background: #f8f9fb;
        }

        .home-citation-block {
            max-width: 760px;
            margin: 0 auto;
            position: relative;
        }

        .home-citation-block pre {
            background: #1e1e1e;
            color: #d4d4d4;
            border-radius: 10px;
            padding: 24px;
            font-size: 13px;
            line-height: 1.6;
            overflow-x: auto;
            font-family: 'SF Mono', Monaco, 'Courier New', monospace;
        }

        .home-citation-copy {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(255,255,255,0.12);
            border: 1px solid rgba(255,255,255,0.2);
            color: #ccc;
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .home-citation-copy:hover {
            background: rgba(255,255,255,0.2);
            color: #fff;
        }

        /* Footer */
        .home-footer {
            text-align: center;
            padding: 28px 32px;
            font-size: 13px;
            color: #999;
            border-top: 1px solid #eef0f5;
        }

        .home-footer a {
            color: #667eea;
            text-decoration: none;
        }

        .home-footer a:hover {
            text-decoration: underline;
        }

        /* Homepage responsive */
        @media (max-width: 900px) {
            .home-hero h1 { font-size: 32px; }
            .home-hero .subtitle { font-size: 18px; }
            .home-explore-inner { grid-template-columns: 1fr; }
            .home-stats-strip { grid-template-columns: repeat(3, 1fr); }
            .home-findings-grid { grid-template-columns: 1fr; }
            .home-hero-btns { flex-direction: column; align-items: center; }
        }

        @media (max-width: 600px) {
            .home-hero { padding: 40px 20px 36px; }
            .home-hero h1 { font-size: 28px; }
            .home-stats-strip { grid-template-columns: repeat(2, 1fr); }
            .home-section { padding: 0 16px; }
            .home-abstract-section, .home-figure-section,
            .home-stats-section, .home-results-section,
            .home-findings-section, .home-citation-section { padding-left: 16px; padding-right: 16px; }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="nav-bar">
        <div class="nav-brand">
            <span style="font-size: 24px;">üî¨</span>
            <span>SkillCraft</span>
        </div>

        <div class="nav-tabs">
            <div class="nav-tab active" data-page="home" onclick="switchPage('home')">
                <span>üè†</span>
                <span>Home</span>
            </div>
            <div class="nav-tab" data-page="tasks" onclick="switchPage('tasks')">
                <span>üìã</span>
                <span>Task Definitions</span>
            </div>
            <div class="nav-tab" data-page="traj" onclick="switchPage('traj')">
                <span>üìä</span>
                <span>Trajectory Comparison</span>
            </div>
        </div>
    </nav>
    
    <!-- Global Tooltip Container -->
    <div id="globalTooltip"></div>

    <!-- ===== HOME PAGE ===== -->
    <div id="homePage" class="page-container active">

        <!-- Hero -->
        <div class="home-hero">
            <div class="home-hero-inner">
                <h1>SkillCraft</h1>
                <div class="subtitle">Can LLM Agents Learn to Use Tools Skillfully?</div>
                <div class="tagline">
                    A benchmark with 126 realistic tasks to evaluate whether LLM agents can identify, compose, cache, and reuse multi-step tool sequences ‚Äî achieving higher success with dramatically fewer tokens.
                </div>
                <div class="home-hero-btns">
                    <a href="#" class="home-hero-btn primary" target="_blank">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M4.5 4.5a.5.5 0 0 0-.5.5v6a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v3a1.5 1.5 0 0 1-1.5 1.5h-7A1.5 1.5 0 0 1 3 11V5a1.5 1.5 0 0 1 1.5-1.5h3a.5.5 0 0 1 0 1h-3zM9 3.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0V4.707l-4.146 4.147a.5.5 0 0 1-.708-.708L11.293 4H9.5a.5.5 0 0 1-.5-.5z"/></svg>
                        Paper (arXiv)
                    </a>
                    <a href="https://github.com/shiqichen17/SkillCraft" class="home-hero-btn" target="_blank">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
                        GitHub
                    </a>
                    <a href="./SkillCraft.pdf" class="home-hero-btn" target="_blank">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5L9.5 0H4zm5 0v3.5A1.5 1.5 0 0 0 10.5 5H14v9a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5z"/></svg>
                        PDF
                    </a>
                </div>
            </div>
        </div>

        <!-- Authors -->
        <div class="home-authors">
            <div class="home-authors-list">
                Shiqi Chen<sup>1,*</sup>,
                Jingze Gai<sup>2,*</sup>,
                Ruochen Zhou<sup>3,*</sup>,
                Jinghan Zhang<sup>1,*</sup>,
                Tongyao Zhu<sup>4,*</sup>,
                Junlong Li<sup>1</sup>,
                Kangrui Wang<sup>1</sup>,
                Zihan Wang<sup>5</sup>,
                Zhengyu Chen<sup>2</sup>,
                Klara Kaleb<sup>1</sup>,
                Ning Miao<sup>1</sup>,
                Siyang Gao<sup>2</sup>,
                Cong Lu<sup>6</sup>,
                Manling Li<sup>3</sup>,
                Junxian He<sup>4</sup>,
                Yee Whye Teh<sup>1</sup>
            </div>
            <div class="home-affiliations">
                <sup>1</sup>University of Oxford &nbsp;&nbsp;
                <sup>2</sup>City University of Hong Kong &nbsp;&nbsp;
                <sup>3</sup>Northwestern University &nbsp;&nbsp;
                <sup>4</sup>Hong Kong University of Science and Technology &nbsp;&nbsp;
                <sup>5</sup>National University of Singapore &nbsp;&nbsp;
                <sup>6</sup>Google DeepMind &nbsp;&nbsp;
                <sup>7</sup>Zhejiang University
            </div>
            <div class="home-equal">* Equal contribution</div>
        </div>

        <!-- Explore Cards -->
        <div class="home-explore">
            <div class="home-explore-inner">
                <div class="home-explore-card" onclick="switchPage('tasks')">
                    <span class="card-icon">üìã</span>
                    <span class="card-title">Browse Task Definitions</span>
                    <span class="card-desc">126 tasks across 21 families and 6 application domains, with full prompts and configurations.</span>
                </div>
                <div class="home-explore-card" onclick="switchPage('traj')">
                    <span class="card-icon">üìä</span>
                    <span class="card-title">Compare Model Trajectories</span>
                    <span class="card-desc">Side-by-side base vs. skill mode execution traces for 7 frontier models.</span>
                </div>
            </div>
        </div>

        <!-- Abstract -->
        <div class="home-abstract-section">
            <div class="home-section">
                <div class="home-section-title">Overview</div>
                <div class="home-section-sub">What is SkillCraft and why does it matter?</div>
            </div>
            <div class="home-abstract">
                <p>
                    Real-world tool-using agents operate over long-horizon workflows with recurring structure and diverse demands, where effective behavior requires not only invoking atomic tools but also <strong>abstracting and reusing higher-level tool compositions</strong>. However, existing benchmarks mainly measure instance-level success under static tool sets, offering limited insight into agents' ability to acquire such reusable skills.
                </p>
                <p>
                    We address this gap by introducing <strong>SkillCraft</strong>, a benchmark explicitly designed to stress-test agent ability to form and reuse higher-level tool compositions, which we call <strong>Skills</strong>. SkillCraft features realistic, highly compositional tool-use scenarios with difficulty scaled along both quantitative and structural dimensions, designed to elicit skill abstraction and cross-task reuse.
                </p>
                <p>
                    We further propose a lightweight <strong>Skill Mode</strong> evaluation protocol that enables agents to autonomously discover, compose, cache, and execute reusable Skills ‚Äî accumulating a persistent library of verified skills over time. This plug-and-play mechanism dramatically improves efficiency and success, reducing token usage by up to 80%.
                </p>
            </div>
        </div>

        <!-- Figure: Skill Demo -->
        <div class="home-figure-section">
            <div class="home-figure">
                <img src="./assets/figure-pipeline.png" alt="SkillCraft Protocol Pipeline Overview">
                <div class="home-figure-caption">
                    <strong>Figure: SkillCraft Protocol Pipeline Overview.</strong>
                    (1) <em>Test-Time Tool Chain Evolution:</em> The agent explores and chains atomic tools, forming executable tool sequences.
                    (2) <em>Iterative Skill Composition:</em> Successful sequences are abstracted into candidate skills, executed and verified in a coding environment; failed executions trigger re-exploration.
                    (3) <em>Skill Library:</em> A growing repository of verified, reusable skills that can be retrieved in later tasks to reduce low-level tool exploration.
                </div>
            </div>
        </div>

        <!-- Figure: Efficiency Explanation -->
        <div class="home-figure-section">
            <div class="home-figure">
                <img src="./assets/figure-efficiency.png" alt="Why Skill Mode improves efficiency" style="max-width: 820px;">
                <div class="home-figure-caption">
                    <strong>Why can Skill Mode improve efficiency?</strong>
                    In normal mode, token-heavy tool outputs make agent thinking dense ‚Äî and the same verbose output becomes the next input, compounding cost.
                    In Skill Mode, the agent composes a reusable skill (code-as-think) that processes outputs concisely, so each piece of information only needs to pass through once.
                </div>
            </div>
        </div>

        <!-- Key Stats Strip -->
        <div class="home-stats-section">
            <div class="home-stats-strip">
                <div class="home-stat-card">
                    <div class="home-stat-number">126</div>
                    <div class="home-stat-label">Tasks</div>
                </div>
                <div class="home-stat-card">
                    <div class="home-stat-number">21</div>
                    <div class="home-stat-label">Task Families</div>
                </div>
                <div class="home-stat-card">
                    <div class="home-stat-number">7</div>
                    <div class="home-stat-label">Models Evaluated</div>
                </div>
                <div class="home-stat-card">
                    <div class="home-stat-number">6</div>
                    <div class="home-stat-label">Domains</div>
                </div>
                <div class="home-stat-card">
                    <div class="home-stat-number">79%</div>
                    <div class="home-stat-label">Max Token Savings</div>
                </div>
            </div>
        </div>

        <!-- Main Results Table -->
        <div class="home-results-section">
            <div class="home-section">
                <div class="home-section-title">Main Results</div>
                <div class="home-section-sub">Base mode vs. Skill mode comparison across 7 frontier models on 126 tasks</div>
            </div>
            <div class="home-results-table-wrap">
                <table class="home-results-table">
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>Skill Exec</th>
                            <th>Reuse Factor</th>
                            <th>Success (Base)</th>
                            <th>Success (Skill)</th>
                            <th>&#916; Success</th>
                            <th>Token &#916;</th>
                            <th>Cost &#916;</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="model-type-row"><td colspan="8">Open-Source Models</td></tr>
                        <tr>
                            <td>Kimi-K2-Thinking</td>
                            <td>70%</td>
                            <td>3.4&times;</td>
                            <td class="success-base">55/126 (44%)</td>
                            <td class="success-skill">56/126 (44%)</td>
                            <td class="delta-neutral">+0.8%</td>
                            <td><span class="token-reduction medium">-42%</span></td>
                            <td><span class="token-reduction medium">-39%</span></td>
                        </tr>
                        <tr>
                            <td>DeepSeek-V3.2-EXP</td>
                            <td>71%</td>
                            <td>4.8&times;</td>
                            <td class="success-base">76/126 (60%)</td>
                            <td class="success-skill">87/126 (69%)</td>
                            <td class="delta-positive">+8.7%</td>
                            <td><span class="token-reduction medium">-49%</span></td>
                            <td><span class="token-reduction high">-51%</span></td>
                        </tr>
                        <tr>
                            <td>DeepSeek-R1</td>
                            <td>62%</td>
                            <td>3.4&times;</td>
                            <td class="success-base">89/126 (71%)</td>
                            <td class="success-skill">101/126 (80%)</td>
                            <td class="delta-positive">+9.5%</td>
                            <td><span class="token-reduction low">-30%</span></td>
                            <td><span class="token-reduction low">-24%</span></td>
                        </tr>
                        <tr>
                            <td>GLM-4.7</td>
                            <td>91%</td>
                            <td>3.7&times;</td>
                            <td class="success-base">91/126 (72%)</td>
                            <td class="success-skill">108/126 (86%)</td>
                            <td class="delta-positive">+13.5%</td>
                            <td><span class="token-reduction medium">-39%</span></td>
                            <td><span class="token-reduction medium">-41%</span></td>
                        </tr>
                        <tr>
                            <td>Minimax-M2.1</td>
                            <td>100%</td>
                            <td>3.2&times;</td>
                            <td class="success-base">117/126 (93%)</td>
                            <td class="success-skill">119/126 (94%)</td>
                            <td class="delta-positive">+1.6%</td>
                            <td><span class="token-reduction low">-11%</span></td>
                            <td><span class="token-reduction low">-8%</span></td>
                        </tr>
                        <tr class="model-type-row"><td colspan="8">Closed-Source Models</td></tr>
                        <tr>
                            <td>GPT-5.2</td>
                            <td>84%</td>
                            <td>3.8&times;</td>
                            <td class="success-base">109/126 (87%)</td>
                            <td class="success-skill">114/126 (90%)</td>
                            <td class="delta-positive">+4.0%</td>
                            <td><span class="token-reduction high">-79%</span></td>
                            <td><span class="token-reduction high">-75%</span></td>
                        </tr>
                        <tr>
                            <td>Gemini 3 Pro</td>
                            <td>93%</td>
                            <td>3.9&times;</td>
                            <td class="success-base">108/126 (86%)</td>
                            <td class="success-skill">116/126 (92%)</td>
                            <td class="delta-positive">+6.3%</td>
                            <td><span class="token-reduction high">-54%</span></td>
                            <td><span class="token-reduction medium">-49%</span></td>
                        </tr>
                        <tr>
                            <td>Claude 4.5 Sonnet</td>
                            <td>81%</td>
                            <td>3.4&times;</td>
                            <td class="success-base">119/126 (94%)</td>
                            <td class="success-skill">121/126 (96%)</td>
                            <td class="delta-positive">+1.6%</td>
                            <td><span class="token-reduction high">-71%</span></td>
                            <td><span class="token-reduction high">-74%</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="home-table-note">
                Data from Table 2 of the paper. Token &#916; and Cost &#916; represent percentage change from base to skill mode (negative = reduction).
            </div>
        </div>

        <!-- Key Findings -->
        <div class="home-findings-section">
            <div class="home-section">
                <div class="home-section-title">Key Findings</div>
                <div class="home-section-sub">Insights from evaluating 7 frontier models on the SkillCraft benchmark</div>
            </div>
            <div class="home-findings-grid">
                <div class="home-finding-card">
                    <div class="finding-number">1</div>
                    <h3>Skill Reuse Boosts Success</h3>
                    <p>
                        Skill Mode improves task success rate across all models. Mid-tier models show the largest gains ‚Äî GLM-4.7 jumps from 72% to 86%, and DeepSeek-R1 from 71% to 80% ‚Äî demonstrating that skill composition can bridge capability gaps.
                    </p>
                    <span class="finding-metric">Up to +13.5% success gain</span>
                </div>
                <div class="home-finding-card">
                    <div class="finding-number">2</div>
                    <h3>Dramatic Efficiency Gains</h3>
                    <p>
                        Agents accomplish the same tasks with far fewer tokens by reusing cached skill compositions instead of re-exploring from scratch. GPT-5.2 achieves 79% token reduction and 75% cost reduction while improving accuracy.
                    </p>
                    <span class="finding-metric">Up to 79% fewer tokens</span>
                </div>
                <div class="home-finding-card">
                    <div class="finding-number">3</div>
                    <h3>Skill Ability Scales with Strength</h3>
                    <p>
                        Stronger models achieve higher skill execution rates (81‚Äì100%) and reuse factors (3.2‚Äì4.8&times;). Success rate correlates strongly with tool composition ability, underscoring skill acquisition as a core LLM capability.
                    </p>
                    <span class="finding-metric">3.2‚Äì4.8&times; reuse factor</span>
                </div>
            </div>
        </div>

        <!-- Figure: Task Construction Pipeline -->
        <div class="home-figure-section" style="padding-top: 0;">
            <div class="home-figure">
                <img src="./assets/figure-task-construction.png" alt="Three-stage task construction pipeline" style="max-width: 780px;">
                <div class="home-figure-caption">
                    <strong>Three-stage task construction pipeline.</strong>
                    <em>Stage 1 (Exploratory Phase):</em> Survey existing benchmarks to derive task design principles.
                    <em>Stage 2 (Seed Task Construction):</em> Build seed tasks from Web APIs and local tools.
                    <em>Stage 3 (Systematic Scaling):</em> Scale along entity count and subtask complexity to create 126 benchmark tasks.
                </div>
            </div>
        </div>

        <!-- Task Distribution Figure -->
        <div class="home-figure-section" style="padding-top: 0;">
            <div class="home-figure">
                <img src="./assets/figure-task-distribution.png" alt="Task Distribution in SkillCraft" style="max-width: 440px;">
                <div class="home-figure-caption">
                    <strong>Task distribution in SkillCraft.</strong>
                    21 task families across 6 application domains (Food & Lifestyle, Science & Environment, Developer & Web, Education & Society, Reference, Entertainment & Gaming).
                    Tasks span 3 difficulty levels: Easy (63), Medium (42), and Hard (21), with systematic complexity scaling through entity count and subtask multiplicity.
                </div>
            </div>
        </div>

        <!-- Citation -->
        <div class="home-citation-section">
            <div class="home-section">
                <div class="home-section-title">Citation</div>
                <div class="home-section-sub">If you find SkillCraft useful in your research, please cite our paper</div>
            </div>
            <div class="home-citation-block">
                <button class="home-citation-copy" onclick="copyBibtex()">Copy BibTeX</button>
                <pre id="bibtexContent">@article{chen2026skillcraft,
  title   = {SkillCraft: Can LLM Agents Learn to Use Tools Skillfully?},
  author  = {Shiqi Chen and Jingze Gai and Ruochen Zhou and Jinghan Zhang and
             Tongyao Zhu and Junlong Li and Kangrui Wang and Zihan Wang and
             Zhengyu Chen and Klara Kaleb and Ning Miao and Siyang Gao and
             Cong Lu and Manling Li and Junxian He and Yee Whye Teh},
  journal = {arXiv preprint},
  year    = {2026}
}</pre>
            </div>
        </div>

        <!-- Footer -->
        <div class="home-footer">
            SkillCraft &copy; 2026 &nbsp;|&nbsp;
            <a href="https://github.com/shiqichen17/SkillCraft" target="_blank">GitHub</a> &nbsp;|&nbsp;
            <a href="#" target="_blank">arXiv</a> &nbsp;|&nbsp;
            <a href="./SkillCraft.pdf" target="_blank">PDF</a>
        </div>

    </div>

    <!-- ===== TRAJECTORY PAGE ===== -->
    <div id="trajPage" class="page-container">
        <div class="top-bar">
            <div class="controls">
                <span class="brand">üî¨ Multi-Model Comparison</span>
                <select id="modelSelect" class="model-select" onchange="trajUpdateGroupSelect()">
                    <option value="">-- Select Model --</option>
                </select>
                <select id="trajTaskSelect" onchange="trajLoadTask()">
                    <option value="">-- Select Task --</option>
                </select>
            </div>
            <div class="progress-container">
                <span class="progress-text" id="progressText">Base: 0 steps | Skill: 0 steps</span>
            </div>
        </div>
        
        <div class="main-content">
            <div class="stats-panel">
                <div class="panel-content" id="statsContent">
                    <div id="taskInfoSection"></div>
                    <div class="panel-header" style="margin: 0 -16px; padding: 10px 16px;">üìä Statistics Comparison</div>
                    <div id="statsSection">
                        <div class="empty-state">
                            <h3>Select a Task</h3>
                            <p>Choose model, task group, and task</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="traj-panels">
                <div class="traj-panel">
                    <div class="panel-header normal">üîµ Base Mode</div>
                    <div class="messages-container" id="normalMessages">
                        <div class="empty-state">
                            <h3>No Trajectory</h3>
                            <p>Select a task to view trajectory</p>
                        </div>
                    </div>
                </div>
                
                <div class="traj-panel">
                    <div class="panel-header reuse">üü¢ Skill Mode</div>
                    <div class="messages-container" id="reuseMessages">
                        <div class="empty-state">
                            <h3>No Trajectory</h3>
                            <p>Select a task to view trajectory</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ===== TASK SHOWCASE PAGE ===== -->
    <div id="tasksPage" class="page-container">
        <div class="top-bar">
            <div class="controls">
                <span class="brand">üìã Task Showcase</span>
                <select class="task-select" id="showcaseTaskBaseSelect" onchange="showcaseSelectTaskFromDropdowns()">
                    <option value="">Select task base...</option>
                </select>
                <select class="task-select" id="showcaseTaskLevelSelect" onchange="showcaseSelectTaskFromDropdowns()">
                    <option value="">Select difficulty...</option>
                </select>
            </div>
            <div class="stats-summary">
                <div class="stat-item">
                    <span>Total Tasks:</span>
                    <span class="stat-value" id="totalTasksStat">0</span>
                </div>
                <div class="stat-item">
                    <span>API Tasks:</span>
                    <span class="stat-value" id="apiTasksStat">0</span>
                </div>
                <div class="stat-item">
                    <span>Local Tasks:</span>
                    <span class="stat-value" id="localTasksStat">0</span>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <div class="panel-header">üìÅ All Tasks</div>
                <div class="panel-content">
                    <input type="text" class="search-box" id="searchBox" placeholder="Search tasks..." oninput="showcaseFilterTasks()">
                    <ul class="task-list" id="taskList"></ul>
                </div>
            </div>
            
            <div class="content-panel">
                <div class="content-header" id="showcaseContentHeader">
                    <div class="content-title" id="showcaseContentTitle">Select a task to view details</div>
                    <div class="content-meta" id="showcaseContentMeta"></div>
                </div>
                
                <div class="tabs">
                    <div class="tab active" data-tab="prompt" onclick="showcaseSwitchTab('prompt')">Agent Prompt</div>
                    <div class="tab" data-tab="config" onclick="showcaseSwitchTab('config')">Configuration</div>
                    <div class="tab" data-tab="raw" onclick="showcaseSwitchTab('raw')">Raw Config</div>
                </div>
                
                <div class="tab-content">
                    <div class="tab-pane active" id="promptPane">
                        <div class="markdown-content" id="promptContent">
                            <p style="color: #666; text-align: center; padding: 40px;">
                                üëà Select a task from the sidebar or dropdown to view its prompt
                            </p>
                        </div>
                    </div>
                    
                    <div class="tab-pane" id="configPane">
                        <div id="configContent"></div>
                    </div>
                    
                    <div class="tab-pane" id="rawPane">
                        <pre class="raw-json" id="rawContent">Select a task to view its configuration</pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ===== DATA LOADER =====
        const DATA_ROOT = './data';

        let appManifest = null;
        let taskCatalog = {};
        let trajModelCatalog = {};

        const taskDetailCache = new Map();
        const modelIndexCache = new Map();
        const trajDetailCache = new Map();
        const trajEmptyCache = new Map();
        let trajFilterToken = 0;

        // ===== PAGE SWITCHING =====
        function switchPage(page) {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.page === page);
            });
            document.getElementById('homePage').classList.toggle('active', page === 'home');
            document.getElementById('trajPage').classList.toggle('active', page === 'traj');
            document.getElementById('tasksPage').classList.toggle('active', page === 'tasks');
        }

        function copyBibtex() {
            const text = document.getElementById('bibtexContent').textContent;
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.querySelector('.home-citation-copy');
                btn.textContent = 'Copied!';
                setTimeout(() => { btn.textContent = 'Copy BibTeX'; }, 2000);
            });
        }

        function navigateToTaskDetails(taskKey) {
            switchPage('tasks');
            setTimeout(() => {
                showcaseSelectTask(taskKey);
            }, 100);
        }

        async function fetchJson(path) {
            const res = await fetch(path, { cache: 'no-cache' });
            if (!res.ok) {
                throw new Error(`Failed to load ${path} (${res.status})`);
            }
            return await res.json();
        }

        function toPrettyText(value) {
            if (value === null || value === undefined) return '';
            if (typeof value === 'string') {
                const trimmed = value.trim();
                if ((trimmed.startsWith('{') && trimmed.endsWith('}')) ||
                    (trimmed.startsWith('[') && trimmed.endsWith(']'))) {
                    try {
                        return JSON.stringify(JSON.parse(trimmed), null, 2);
                    } catch (_) {}
                }
                return value;
            }
            if (typeof value === 'object') {
                try {
                    return JSON.stringify(value, null, 2);
                } catch (_) {
                    return String(value);
                }
            }
            return String(value);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function setEmpty(containerId, title, desc) {
            document.getElementById(containerId).innerHTML = `
                <div class="empty-state">
                    <h3>${escapeHtml(title)}</h3>
                    <p>${escapeHtml(desc)}</p>
                </div>
            `;
        }

        function showStatsError(message) {
            document.getElementById('statsSection').innerHTML = `
                <div class="empty-state">
                    <h3>Load Failed</h3>
                    <p>${escapeHtml(message)}</p>
                </div>
            `;
        }

        // ===== TOOLTIP =====
        const tooltip = document.getElementById('globalTooltip');
        let tooltipTimeout;

        function showTooltip(element, content, title) {
            clearTimeout(tooltipTimeout);
            const rect = element.getBoundingClientRect();

            let tooltipHtml = '';
            if (title) {
                tooltipHtml += `<div class="tooltip-title">üìÑ ${escapeHtml(title)}</div>`;
            }
            tooltipHtml += `<div class="tooltip-code">${escapeHtml(content)}</div>`;
            tooltip.innerHTML = tooltipHtml;
            tooltip.style.display = 'block';

            let left = rect.right + 10;
            let top = rect.top;
            const tooltipRect = tooltip.getBoundingClientRect();

            if (left + tooltipRect.width > window.innerWidth - 20) {
                left = rect.left - tooltipRect.width - 10;
            }
            if (top + tooltipRect.height > window.innerHeight - 20) {
                top = window.innerHeight - tooltipRect.height - 20;
            }
            if (top < 10) top = 10;
            if (left < 10) left = 10;

            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';
        }

        function hideTooltip() {
            tooltipTimeout = setTimeout(() => {
                tooltip.style.display = 'none';
            }, 100);
        }

        tooltip.addEventListener('mouseenter', () => clearTimeout(tooltipTimeout));
        tooltip.addEventListener('mouseleave', hideTooltip);

        // ===== TRAJECTORY PAGE =====
        let currentBaseRenderEntries = [];
        let currentSkillRenderEntries = [];

        async function loadModelIndex(modelDisplay) {
            const meta = trajModelCatalog[modelDisplay];
            if (!meta) throw new Error(`Unknown model: ${modelDisplay}`);

            if (modelIndexCache.has(modelDisplay)) return modelIndexCache.get(modelDisplay);

            const modelIndex = await fetchJson(meta.index_path);
            modelIndexCache.set(modelDisplay, modelIndex);
            return modelIndex;
        }

        async function loadTrajDetail(detailPath) {
            if (trajDetailCache.has(detailPath)) return trajDetailCache.get(detailPath);
            const detail = await fetchJson(detailPath);
            trajDetailCache.set(detailPath, detail);
            return detail;
        }

        function getTrajEntryCounts(payload) {
            const baseEntries = Array.isArray(payload?.base?.entries) ? payload.base.entries.length : 0;
            const skillEntries = Array.isArray(payload?.skill?.entries) ? payload.skill.entries.length : 0;
            return { baseEntries, skillEntries };
        }

        async function isTrajectoryEmpty(taskMeta) {
            if (!taskMeta?.detail_path) return true;
            if (trajEmptyCache.has(taskMeta.detail_path)) return trajEmptyCache.get(taskMeta.detail_path);
            try {
                const detail = await loadTrajDetail(taskMeta.detail_path);
                const counts = getTrajEntryCounts(detail);
                const empty = counts.baseEntries === 0 && counts.skillEntries === 0;
                trajEmptyCache.set(taskMeta.detail_path, empty);
                return empty;
            } catch (_) {
                trajEmptyCache.set(taskMeta.detail_path, true);
                return true;
            }
        }

        async function filterEmptyTrajOptions(tasks, token) {
            const taskSelect = document.getElementById('trajTaskSelect');
            const concurrency = 4;
            let index = 0;
            const getFirstRealOption = () =>
                taskSelect.querySelector('option[value]:not([value=""])');

            async function worker() {
                while (index < tasks.length) {
                    const current = tasks[index++];
                    if (token !== trajFilterToken) return;
                    const empty = await isTrajectoryEmpty(current);
                    if (token !== trajFilterToken) return;
                    if (empty) {
                        const opt = taskSelect.querySelector(`option[value="${current.task_key}"]`);
                        if (opt) opt.remove();
                    }
                }
            }

            const workers = Array.from({ length: concurrency }, () => worker());
            await Promise.all(workers);

            if (token !== trajFilterToken) return;
            const selected = taskSelect.value;
            const stillExists = selected && taskSelect.querySelector(`option[value="${selected}"]`);
            if (!stillExists) {
                const first = getFirstRealOption();
                if (first) {
                    taskSelect.value = first.value;
                    await trajLoadTask();
                } else {
                    document.getElementById('taskInfoSection').innerHTML = '';
                    document.getElementById('statsSection').innerHTML = '<div class="empty-state">No stats available</div>';
                    setEmpty('normalMessages', 'No Data', 'No trajectories available for this model');
                    setEmpty('reuseMessages', 'No Data', 'No trajectories available for this model');
                    document.getElementById('progressText').textContent = 'Base: 0 steps | Skill: 0 steps';
                }
            }
        }

        function getRawForEntry(trajPayload, entry) {
            const rawMessages = Array.isArray(trajPayload?.raw_messages) ? trajPayload.raw_messages : [];
            const msg = rawMessages[entry.msg_idx] || {};
            if (entry.kind === 'tool-call') {
                const calls = Array.isArray(msg.tool_calls) ? msg.tool_calls : [];
                return calls[entry.tool_call_idx] || {};
            }
            return msg;
        }

        function buildRenderEntries(trajPayload) {
            const entries = Array.isArray(trajPayload?.entries) ? trajPayload.entries : [];
            const out = [];

            for (const entry of entries) {
                const raw = getRawForEntry(trajPayload, entry);
                let cssClass = 'assistant-message';
                let header = 'ü§ñ Assistant';
                let content = '';

                if (entry.kind === 'user') {
                    cssClass = 'user-message';
                    header = 'üë§ User';
                    content = raw?.content;
                } else if (entry.kind === 'assistant') {
                    cssClass = 'assistant-message';
                    header = 'ü§ñ Assistant';
                    content = raw?.content;
                } else if (entry.kind === 'tool-call') {
                    cssClass = 'tool-call';
                    const fn = raw?.function || {};
                    const name = fn?.name || raw?.name || 'unknown_tool';
                    header = `üîß Tool: ${name}`;
                    content = fn?.arguments ?? raw?.arguments ?? '';
                } else if (entry.kind === 'tool-output') {
                    cssClass = 'tool-output';
                    header = 'üì§ Output';
                    content = raw?.content;
                }

                out.push({
                    kind: entry.kind,
                    cssClass,
                    header,
                    content: toPrettyText(content),
                    raw,
                });
            }

            return out;
        }

        function renderUserMarkdown(text) {
            if (text === null || text === undefined) return '';
            const lines = String(text).replace(/\r\n/g, '\n').split('\n');
            let html = '';
            let inCode = false;
            let inTips = false;
            let codeBuffer = [];
            let tipsBuffer = [];
            let tableBuffer = [];

            const flushCode = () => {
                if (codeBuffer.length) {
                    html += `<pre class="md-code">${escapeHtml(codeBuffer.join('\n'))}</pre>`;
                    codeBuffer = [];
                }
            };

            const flushTips = () => {
                if (tipsBuffer.length) {
                    html += `<pre class="md-tips">${escapeHtml(tipsBuffer.join('\n'))}</pre>`;
                    tipsBuffer = [];
                }
            };

            const flushTable = () => {
                if (tableBuffer.length) {
                    html += `<pre class="md-table">${escapeHtml(tableBuffer.join('\n'))}</pre>`;
                    tableBuffer = [];
                }
            };

            const isHeading = line => /^#{1,3}\s+/.test(line.trim());
            const isTipsHeading = title => /^tips\b/i.test(title.trim());
            const isTableLine = line => /^\s*\|/.test(line) && line.includes('|');

            for (const line of lines) {
                const trimmed = line.trim();
                const isFence = trimmed.startsWith('```');

                if (inCode) {
                    if (isFence) {
                        flushCode();
                        inCode = false;
                    } else {
                        codeBuffer.push(line);
                    }
                    continue;
                }

                if (inTips) {
                    if (isHeading(trimmed)) {
                        flushTips();
                        inTips = false;
                        // fall through to process heading line
                    } else {
                        tipsBuffer.push(line);
                        continue;
                    }
                }

                if (isFence) {
                    flushTable();
                    inCode = true;
                    codeBuffer = [];
                    continue;
                }

                if (isTableLine(line)) {
                    tableBuffer.push(line);
                    continue;
                }
                flushTable();

                const headingMatch = line.match(/^(#{1,3})\s+(.*)$/);
                if (headingMatch) {
                    const level = headingMatch[1].length;
                    const title = headingMatch[2] || '';
                    const cls = level === 1 ? 'md-h1' : level === 2 ? 'md-h2' : 'md-h3';
                    html += `<div class="${cls}">${escapeHtml(title)}</div>`;
                    if (isTipsHeading(title)) {
                        inTips = true;
                        tipsBuffer = [];
                    }
                    continue;
                }

                if (/^tips\s*:/i.test(line)) {
                    const label = line.replace(/^tips\s*:/i, 'Tips');
                    html += `<div class="md-h3">${escapeHtml(label)}</div>`;
                    inTips = true;
                    tipsBuffer = [];
                    continue;
                }

                if (trimmed === '') {
                    html += '<div class="md-spacer"></div>';
                    continue;
                }

                const escaped = escapeHtml(line);
                const formatted = escaped.replace(/\*\*([^*]+)\*\*/g, '<span class="md-bold">$1</span>');
                html += `<div class="md-line">${formatted}</div>`;
            }

            if (inCode) flushCode();
            if (inTips) flushTips();
            flushTable();
            return html;
        }

        function renderMessageBody(entry) {
            if (entry.kind === 'user') {
                return `<div class="user-markdown">${renderUserMarkdown(entry.content)}</div>`;
            }
            return `<pre>${escapeHtml(entry.content)}</pre>`;
        }

        function renderMessageEntries(containerId, entries, stream) {
            const container = document.getElementById(containerId);
            if (!entries || entries.length === 0) {
                setEmpty(containerId, 'No Trajectory', 'No trajectory data available');
                return;
            }

            container.innerHTML = entries.map((entry, idx) => `
                <div class="message ${entry.cssClass} has-raw-tooltip" data-stream="${stream}" data-entry-index="${idx}">
                    <div class="message-header">${escapeHtml(entry.header)}</div>
                    <div class="message-content">${renderMessageBody(entry)}</div>
                </div>
            `).join('');
        }

        function trajBindPatternTooltips() {
            document.querySelectorAll('.pattern-item[data-tooltip]').forEach(item => {
                item.addEventListener('mouseenter', function() {
                    const content = this.getAttribute('data-tooltip');
                    const name = this.querySelector('.pattern-name')?.textContent || 'Skill';
                    showTooltip(this, content, name);
                });
                item.addEventListener('mouseleave', hideTooltip);
            });
        }

        function trajBindMessageTooltips() {
            document.querySelectorAll('.has-raw-tooltip').forEach(item => {
                item.addEventListener('mouseenter', function() {
                    const stream = this.getAttribute('data-stream');
                    const idx = Number(this.getAttribute('data-entry-index'));
                    const entries = stream === 'base' ? currentBaseRenderEntries : currentSkillRenderEntries;
                    const raw = entries[idx]?.raw;
                    if (raw !== undefined) {
                        showTooltip(this, toPrettyText(raw), 'Raw JSON');
                    }
                });
                item.addEventListener('mouseleave', hideTooltip);
            });
        }

        function trajBindAllTooltips() {
            trajBindPatternTooltips();
            trajBindMessageTooltips();
        }

        async function trajInit() {
            const modelSelect = document.getElementById('modelSelect');
            modelSelect.innerHTML = '<option value="">-- Select Model --</option>';

            const modelNames = appManifest?.models || Object.keys(trajModelCatalog);
            modelNames.forEach(model => {
                const option = document.createElement('option');
                option.value = model;
                option.textContent = model;
                modelSelect.appendChild(option);
            });

            if (modelNames.length > 0) {
                modelSelect.value = modelNames[0];
                await trajUpdateGroupSelect();
            }
        }

        async function trajUpdateGroupSelect() {
            const model = document.getElementById('modelSelect').value;
            const taskSelect = document.getElementById('trajTaskSelect');

            taskSelect.innerHTML = '<option value="">-- Select Task --</option>';

            if (!model) return;

            try {
                await trajUpdateTaskSelect();
            } catch (err) {
                showStatsError(err.message || String(err));
            }
        }

        async function trajUpdateTaskSelect() {
            const model = document.getElementById('modelSelect').value;
            const taskSelect = document.getElementById('trajTaskSelect');

            taskSelect.innerHTML = '<option value="">-- Select Task --</option>';
            if (!model) return;

            try {
                const modelIndex = await loadModelIndex(model);
                const tasks = modelIndex.tasks || [];

                tasks.sort((a, b) => a.task_key.localeCompare(b.task_key));

                tasks.forEach(t => {
                    const option = document.createElement('option');
                    option.value = t.task_key;
                    option.textContent = t.task_key;
                    taskSelect.appendChild(option);
                });

                const first = taskSelect.querySelector('option[value]:not([value=""])');
                if (first) {
                    taskSelect.value = first.value;
                    await trajLoadTask();
                }

                const token = ++trajFilterToken;
                filterEmptyTrajOptions(tasks, token);
            } catch (err) {
                showStatsError(err.message || String(err));
            }
        }

        async function trajLoadTask() {
            const model = document.getElementById('modelSelect').value;
            const task = document.getElementById('trajTaskSelect').value;
            if (!model || !task) return;

            setEmpty('normalMessages', 'Loading...', 'Loading base trajectory');
            setEmpty('reuseMessages', 'Loading...', 'Loading skill trajectory');

            try {
                const modelIndex = await loadModelIndex(model);
                const taskMeta = (modelIndex.tasks || []).find(t => t.task_key === task);
                if (!taskMeta) throw new Error(`Task not found in model index: ${task}`);

                const data = await loadTrajDetail(taskMeta.detail_path);
                const counts = getTrajEntryCounts(data);
                if (counts.baseEntries === 0 && counts.skillEntries === 0) {
                    trajEmptyCache.set(taskMeta.detail_path, true);
                    const taskSelect = document.getElementById('trajTaskSelect');
                    const opt = taskSelect.querySelector(`option[value="${taskMeta.task_key}"]`);
                    if (opt) opt.remove();
                    const next = taskSelect.querySelector('option[value]:not([value=""])');
                    if (next) {
                        taskSelect.value = next.value;
                        await trajLoadTask();
                        return;
                    }
                    document.getElementById('taskInfoSection').innerHTML = '';
                    document.getElementById('statsSection').innerHTML = '<div class="empty-state">No stats available</div>';
                    setEmpty('normalMessages', 'No Data', 'No trajectories available for this model');
                    setEmpty('reuseMessages', 'No Data', 'No trajectories available for this model');
                    document.getElementById('progressText').textContent = 'Base: 0 steps | Skill: 0 steps';
                    return;
                }

                const taskInfo = data.task_info || {};
                const cleanTaskName = task.replace(/^SingleUserTurn-/, '');
                let taskInfoHtml = '';
                if (taskInfo.task_name) {
                    taskInfoHtml = `
                        <div class="task-info">
                            <h3>üìã ${escapeHtml(taskInfo.task_name)}</h3>
                            ${taskInfo.description ? `<div class="task-desc">${escapeHtml(taskInfo.description)}</div>` : ''}
                            <div class="view-details-btn" onclick="navigateToTaskDetails('${cleanTaskName}')">
                                üìÑ View Full Task Details
                            </div>
                        </div>
                    `;
                }
                document.getElementById('taskInfoSection').innerHTML = taskInfoHtml;
                document.getElementById('statsSection').innerHTML = data.stats_html || '<div class="empty-state">No stats available</div>';

                currentBaseRenderEntries = buildRenderEntries(data.base || {});
                currentSkillRenderEntries = buildRenderEntries(data.skill || {});

                renderMessageEntries('normalMessages', currentBaseRenderEntries, 'base');
                renderMessageEntries('reuseMessages', currentSkillRenderEntries, 'skill');

                document.getElementById('progressText').textContent =
                    `Base: ${currentBaseRenderEntries.length} steps | Skill: ${currentSkillRenderEntries.length} steps`;

                setTimeout(trajBindAllTooltips, 30);
            } catch (err) {
                showStatsError(err.message || String(err));
                setEmpty('normalMessages', 'Load Failed', err.message || String(err));
                setEmpty('reuseMessages', 'Load Failed', err.message || String(err));
            }
        }

        // ===== TASK SHOWCASE PAGE =====
        let showcaseCurrentTask = null;
        const TASK_LEVEL_ORDER = ['e1', 'e2', 'e3', 'm1', 'm2', 'h1'];
        let taskBaseIndex = {};

        function parseTaskKey(taskKey) {
            const m = String(taskKey || '').match(/^(.*)-(e1|e2|e3|m1|m2|h1)$/i);
            if (!m) return null;
            return { base: m[1], level: m[2].toLowerCase() };
        }

        function baseLabelFromKey(baseKey) {
            return baseKey
                .split('-')
                .map(x => x ? x[0].toUpperCase() + x.slice(1) : x)
                .join(' ');
        }

        function sortedTasksEntries() {
            return Object.entries(taskCatalog).sort((a, b) => {
                return a[1].display_name.localeCompare(b[1].display_name);
            });
        }

        async function loadTaskDetail(taskKey) {
            if (taskDetailCache.has(taskKey)) return taskDetailCache.get(taskKey);
            const meta = taskCatalog[taskKey];
            if (!meta) throw new Error(`Unknown task key: ${taskKey}`);
            const detail = await fetchJson(meta.detail_path);
            const merged = { ...meta, ...detail };
            taskDetailCache.set(taskKey, merged);
            return merged;
        }

        function buildTaskBaseIndex() {
            taskBaseIndex = {};
            sortedTasksEntries().forEach(([taskKey, task]) => {
                const parsed = parseTaskKey(taskKey);
                if (!parsed) return;
                if (!taskBaseIndex[parsed.base]) taskBaseIndex[parsed.base] = {};
                taskBaseIndex[parsed.base][parsed.level] = taskKey;
            });
        }

        function showcasePopulateTaskBaseSelect() {
            const baseSelect = document.getElementById('showcaseTaskBaseSelect');
            baseSelect.innerHTML = '<option value="">Select task base...</option>';

            Object.keys(taskBaseIndex).sort().forEach(baseKey => {
                const option = document.createElement('option');
                option.value = baseKey;
                option.textContent = baseLabelFromKey(baseKey);
                baseSelect.appendChild(option);
            });
        }

        function showcasePopulateTaskLevelSelect(baseKey, preferredLevel = '') {
            const levelSelect = document.getElementById('showcaseTaskLevelSelect');
            levelSelect.innerHTML = '<option value="">Select difficulty...</option>';
            if (!baseKey || !taskBaseIndex[baseKey]) return;

            TASK_LEVEL_ORDER.forEach(level => {
                if (!taskBaseIndex[baseKey][level]) return;
                const option = document.createElement('option');
                option.value = level;
                option.textContent = level.toUpperCase();
                levelSelect.appendChild(option);
            });

            if (preferredLevel && taskBaseIndex[baseKey][preferredLevel]) {
                levelSelect.value = preferredLevel;
            }
        }

        function showcaseUpdateStatsSummary() {
            const entries = Object.entries(taskCatalog);
            const total = entries.length;
            const local = entries.filter(([k]) => k.includes('local-')).length;
            const api = total - local;
            document.getElementById('totalTasksStat').textContent = String(total);
            document.getElementById('apiTasksStat').textContent = String(api);
            document.getElementById('localTasksStat').textContent = String(local);
        }

        function showcasePopulateTaskList() {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '';

            sortedTasksEntries().forEach(([key, task]) => {
                const li = document.createElement('li');
                li.className = 'task-item';
                li.dataset.task = key;

                const isLocal = key.includes('local-');
                const difficultyClass = task.difficulty === 'easy' ? 'badge-easy' :
                                        task.difficulty === 'medium' ? 'badge-medium' : 'badge-hard';

                li.innerHTML = `
                    <div class="task-item-name">${escapeHtml(task.display_name)}</div>
                    <div class="task-item-meta">
                        <span class="badge ${difficultyClass}">${escapeHtml(task.difficulty)}</span>
                        <span class="badge ${isLocal ? 'badge-local' : 'badge-api'}">${isLocal ? 'Local' : 'API'}</span>
                        <span>${task.subtask_count}√ó${task.calls_per_subtask}</span>
                    </div>
                `;

                li.addEventListener('click', () => showcaseSelectTask(key));
                taskList.appendChild(li);
            });
        }

        function showcaseFilterTasks() {
            const query = document.getElementById('searchBox').value.toLowerCase();
            document.querySelectorAll('.task-item').forEach(item => {
                const taskKey = item.dataset.task;
                const task = taskCatalog[taskKey];
                const matches = taskKey.toLowerCase().includes(query) ||
                               task.display_name.toLowerCase().includes(query) ||
                               task.description.toLowerCase().includes(query);
                item.style.display = matches ? '' : 'none';
            });
        }

        function showcaseSwitchTab(tabName) {
            document.querySelectorAll('#tasksPage .tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('#tasksPage .tab-pane').forEach(p => p.classList.remove('active'));

            document.querySelector(`#tasksPage .tab[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(tabName + 'Pane').classList.add('active');
        }

        function showcaseSelectTaskFromDropdowns() {
            const base = document.getElementById('showcaseTaskBaseSelect').value;
            const level = document.getElementById('showcaseTaskLevelSelect').value;

            if (!base) {
                showcasePopulateTaskLevelSelect('', '');
                return;
            }

            showcasePopulateTaskLevelSelect(base, level);
            if (!level) return;

            const taskKey = taskBaseIndex[base]?.[level];
            if (taskKey) showcaseSelectTask(taskKey);
        }

        async function showcaseSelectTask(taskKey) {
            try {
                const task = await loadTaskDetail(taskKey);
                showcaseCurrentTask = task;

                const parsed = parseTaskKey(taskKey);
                if (parsed && taskBaseIndex[parsed.base]) {
                    const baseSelect = document.getElementById('showcaseTaskBaseSelect');
                    if (baseSelect.value !== parsed.base) {
                        baseSelect.value = parsed.base;
                    }
                    showcasePopulateTaskLevelSelect(parsed.base, parsed.level);
                    document.getElementById('showcaseTaskLevelSelect').value = parsed.level;
                }

                let activeItem = null;
                document.querySelectorAll('.task-item').forEach(item => {
                    const isActive = item.dataset.task === taskKey;
                    item.classList.toggle('active', isActive);
                    if (isActive) activeItem = item;
                });
                if (activeItem) {
                    activeItem.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
                }

                document.getElementById('showcaseContentTitle').textContent = task.display_name;

                const difficultyClass = task.difficulty === 'easy' ? 'badge-easy' :
                                        task.difficulty === 'medium' ? 'badge-medium' : 'badge-hard';
                const isLocal = taskKey.includes('local-');

                document.getElementById('showcaseContentMeta').innerHTML = `
                    <div class="meta-item">
                        <span class="badge ${difficultyClass}">${escapeHtml(task.difficulty)}</span>
                    </div>
                    <div class="meta-item">
                        <span class="badge ${isLocal ? 'badge-local' : 'badge-api'}">${isLocal ? 'Local Files' : 'API Based'}</span>
                    </div>
                    <div class="meta-item">
                        <span>Subtasks:</span>
                        <span class="meta-value">${task.subtask_count}</span>
                    </div>
                    <div class="meta-item">
                        <span>Calls/Subtask:</span>
                        <span class="meta-value">${task.calls_per_subtask}</span>
                    </div>
                    <div class="meta-item">
                        <span>Total Calls:</span>
                        <span class="meta-value">${task.subtask_count * task.calls_per_subtask}</span>
                    </div>
                `;

                document.getElementById('promptContent').innerHTML = task.task_md_html || '';
                showcaseUpdateConfigContent(task);

                document.getElementById('rawContent').textContent = JSON.stringify({
                    task_name: task.name,
                    task_type: task.task_type,
                    meta: {
                        difficulty: task.difficulty,
                        category: task.category,
                        subtask_count: task.subtask_count,
                        calls_per_subtask: task.calls_per_subtask,
                        description: task.description
                    },
                    mcp_servers: task.mcp_servers,
                    local_tools: task.local_tools,
                    tools_used: task.tools_used
                }, null, 2);
            } catch (err) {
                document.getElementById('promptContent').innerHTML = `
                    <p style="color:#c62828; text-align:center; padding:40px;">
                        Failed to load task: ${escapeHtml(err.message || String(err))}
                    </p>
                `;
            }
        }

        function showcaseUpdateConfigContent(task) {
            const container = document.getElementById('configContent');
            const toolsUsed = task.tools_used || [];
            const mcpServers = task.mcp_servers || [];
            const localTools = task.local_tools || [];

            container.innerHTML = `
                <div class="showcase-pattern-info">
                    <h3>üîÑ Skill Reuse Target</h3>
                    <div class="showcase-pattern-stats">
                        <div class="showcase-pattern-stat">
                            <div class="showcase-pattern-stat-value">${task.subtask_count}</div>
                            <div class="showcase-pattern-stat-label">Subtasks</div>
                        </div>
                        <div class="showcase-pattern-stat">
                            <div class="showcase-pattern-stat-value">${task.calls_per_subtask}</div>
                            <div class="showcase-pattern-stat-label">Calls per Subtask</div>
                        </div>
                        <div class="showcase-pattern-stat">
                            <div class="showcase-pattern-stat-value">${task.subtask_count * task.calls_per_subtask}</div>
                            <div class="showcase-pattern-stat-label">Total Tool Calls</div>
                        </div>
                        <div class="showcase-pattern-stat">
                            <div class="showcase-pattern-stat-value">${toolsUsed.length}</div>
                            <div class="showcase-pattern-stat-label">Unique Tools</div>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <h3>üìù Task Information</h3>
                    <div class="config-grid">
                        <div class="config-item">
                            <div class="config-label">Task Name</div>
                            <div class="config-value">${escapeHtml(task.name)}</div>
                        </div>
                        <div class="config-item">
                            <div class="config-label">Task Type</div>
                            <div class="config-value">${escapeHtml(task.task_type)}</div>
                        </div>
                        <div class="config-item">
                            <div class="config-label">Difficulty</div>
                            <div class="config-value">${escapeHtml(task.difficulty)}</div>
                        </div>
                        <div class="config-item">
                            <div class="config-label">Category</div>
                            <div class="config-value">${escapeHtml(task.category)}</div>
                        </div>
                    </div>
                    <p style="margin-top: 12px; color: #666; font-size: 14px;">${escapeHtml(task.description || '')}</p>
                </div>

                <div class="config-section">
                    <h3>üîß Tools Used</h3>
                    <div class="tool-list">
                        ${toolsUsed.map(t => `<span class="tool-tag">${escapeHtml(t)}</span>`).join('')}
                    </div>
                </div>

                <div class="config-section">
                    <h3>üîå Dependencies</h3>
                    <div style="margin-bottom: 12px;">
                        <div class="config-label" style="margin-bottom: 6px;">MCP Servers</div>
                        <div class="tool-list">
                            ${mcpServers.map(s => `<span class="tool-tag mcp">${escapeHtml(s)}</span>`).join('') || '<span style="color: #666;">None</span>'}
                        </div>
                    </div>
                    <div>
                        <div class="config-label" style="margin-bottom: 6px;">Local Tools</div>
                        <div class="tool-list">
                            ${localTools.map(t => `<span class="tool-tag">${escapeHtml(t)}</span>`).join('') || '<span style="color: #666;">None</span>'}
                        </div>
                    </div>
                </div>
            `;
        }

        async function showcaseInit() {
            buildTaskBaseIndex();
            showcasePopulateTaskBaseSelect();
            showcasePopulateTaskLevelSelect('', '');
            showcasePopulateTaskList();
            showcaseUpdateStatsSummary();

            const first = sortedTasksEntries()[0];
            if (first) {
                await showcaseSelectTask(first[0]);
            }
        }

        async function initializeApp() {
            try {
                const [manifest, taskIndex, trajIndex] = await Promise.all([
                    fetchJson('./data/manifest.json'),
                    fetchJson('./data/tasks/index.json'),
                    fetchJson('./data/traj/index.json'),
                ]);

                appManifest = manifest;

                taskCatalog = {};
                (taskIndex.tasks || []).forEach(t => {
                    taskCatalog[t.key] = t;
                });

                trajModelCatalog = {};
                (trajIndex.models || []).forEach(m => {
                    trajModelCatalog[m.display_name] = m;
                });

                await trajInit();
                await showcaseInit();
                trajBindAllTooltips();
            } catch (err) {
                const message = err && err.message ? err.message : String(err);
                showStatsError(message);
                document.getElementById('promptContent').innerHTML = `
                    <p style="color:#c62828; text-align:center; padding:40px;">Failed to initialize page: ${escapeHtml(message)}</p>
                `;
            }
        }

        initializeApp();

</script>
</body>
</html>
